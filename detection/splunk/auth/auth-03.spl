index=auth sourcetype=auth_logs action=login result=success
| sort 0 user _time
| streamstats current=f window=1 last(_time) as prev_time last(geo_country) as prev_country last(geo_city) as prev_city by user
| eval delta=(_time-prev_time)/60
| where isnotnull(prev_time) AND geo_country!=prev_country AND delta < 180
| eval severity="high", detection_id="AUTH-03"
